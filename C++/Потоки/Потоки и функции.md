Классы потоков отличаются от знакомых вам стандартных классов вроде `std::string` и `std::vector`. Рассмотрим эти особенности подробнее.

Потоки ввода-вывода по своей природе принципиально не подвергаются копированию. Это значит, что в функции объекты потоков передаются по ссылке, а не по значению:

```cpp
// Ошибка! Нельзя копировать поток.
void PrintA(std::ostringstream o) {
    o << "A";
}

// OK. Передаём по ссылке.
void PrintA(std::ostringstream& o) {
    o << "A";
} 
```

У потоков `std::istream`, `std::ifstream` и `std::istringstream` много общего. Вы можете считывать из них данные операцией `>>` и функциями наподобие `std::getline`. Это же можно сказать и про потоки вывода. И это не случайное совпадение — классы `std::ifstream`, и `std::istringstream` **унаследованы** от класса `std::istream`.

**Наследование** — это механизм объектно-ориентированного программирования, который позволяет одному классу расширить другой. Подробно наследование вы будете изучать в одном из будущих спринтов, а пока скажем, в чём заключаются особенности и различия между классами потоков.

- Класс `std::istream` содержит операции, общие для всех потоков ввода, а `std::ostream` — операции, общие для всех потоков вывода. Например, операция вывода `<<` может работать с потоком `std::ostream`, а операция ввода `>>` — с потоком ввода `std::istream`.
- Класс `std::istringstream` имеет все методы, которые есть у `std::istream`, и добавляет несколько собственных, например метод [`str`](https://en.cppreference.com/w/cpp/io/basic_istringstream/str). Класс `std::ostringstream` похожим образом расширяет возможности `std::ostream`.
- Класс `std::ifstream` расширяет `std::istream`, а `std::ofstream` — `std::ostream`.
- Класс `std::stringstream` расширяет классы `std::istringstream` и `std::ostringstream`, а класс `std::fstream` — классы `std::ifstream` и `std::ofstream`.

Классы и связи между ними удобно отображать на схеме, которая называется **диаграммой классов**. На этой схеме показано несколько классов потоков стандартной библиотеки C++. Более подробно с диаграммами классов вы познакомитесь в будущих спринтах.

![Схема, которая повторяет структуру связей между классами, описанную выше.](https://code.s3.yandex.net/CPP/assets/c01_2024/s02_qt_basics/streams-sch2.png)

Если функция принимает параметр типа `std::istream&`, то в неё можно передать объект типа `std::ifstream` или `std::istringstream`. Аналогично для `std::ostream`. Это возможно благодаря наследованию:

```cpp
void PrintA(std::ostream& stream) {
    stream << "A";
}

int main() {
    std::ostringstream out;
    // Передаём ostringstream как ссылку на ostream.
    PrintA(out);
    assert(out.str() == "A");
} 
```

Диаграммой классов можно пользоваться так: если от класса `A` до класса `B` можно пройти в направлении стрелочек, значит, объекты класса `A` можно передавать по ссылке в функцию, принимающую класс `B`.

В следующем примере функция `ReadPoint` принимает ссылку на поток чтения `std::istream`, а функция `WritePoint` — ссылку на поток записи `std::ostream`. Благодаря этому можно этими двумя функциями считывать и записывать в потоки, связанные с консолью, строкой в памяти или файлом на диске.

```cpp
#include <fstream>
#include <iostream>
#include <sstream>

struct Point {
    int x, y;
};

// Эта функция выводит точку p в некоторый поток out.
// Внимание: функция принимает поток по ссылке.
void WritePoint(std::ostream& out, Point p) {
    out << p.x << ' ' << p.y;
}

// Эта функция считывает точку из некоторого потока in.
// Внимание, функция принимает поток по ссылке.
Point ReadPoint(std::istream& in) {
    Point p;
    in >> p.x >> p.y;
    return p;
}

int main() {
    // Считываем точку с консоли. Объект std::cin имеет тип std::istream.
    Point p = ReadPoint(std::cin);
    
    std::stringstream str_stream;
    // Записываем точку в поток str_stream.
    WritePoint(str_stream, p);
    
    // Считываем ранее записанную точку из потока str_stream.
    Point q = ReadPoint(str_stream);
    
    std::ofstream file{"point.txt"};
    // Записываем точку в поток, связанный с файлом point.txt.
    WritePoint(file, q);
    
    // Выводим точку в стандартный поток вывода. Объект std::cout имеет тип std:::ostream.
    WritePoint(std::cout, q);
} 
```